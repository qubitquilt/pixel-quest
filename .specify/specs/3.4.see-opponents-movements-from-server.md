# Story 3.4: See Opponents' Movements from Server

## Status
- [x] Draft
- [x] Approved
- [x] In Progress
- [x] Review
- [x] Done

## Story
**As a** player,
**I want** to see my opponents' characters moving on my screen based on server updates
**so that** I know where they are.

## Acceptance Criteria
1. Client listens to GameState changes via Colyseus onChange for player positions/directions.
2. Update other players' sprites (green rectangles) to new x, y from server state.
3. Sync other players' direction for visibility cone calculations.
4. Render other players distinctly from self (e.g., green vs blue).
5. Handle new joins/leaves: Add/remove sprites dynamically.
6. Smooth movement for other players (tween to new positions on update).

## Tasks / Subtasks
- [x] **Client:** Listen to state changes, update other player sprites/positions.
- [x] **Client:** Render other players in green, sync direction for visibility.
- [x] **Client:** Smooth interpolation for other players (tween on receive).
- [x] **Client:** Unit tests: Mock state changes, assert other player updates.

## Dev Notes
- Builds on Story 3.3: In PhaserGame useEffect, set room.state.onChange to call updatePlayer for others.
- Refer to `packages/client/app/components/PhaserGame.tsx` MazeScene.updatePlayer(id, x, y, dir), otherPlayerSprites Map.
- Use tween similar to self-movement for interpolation.
- Integrate with visibility: updateVisibility after other player changes.
- Follow code style: TypeScript, 2-space indentation, camelCase, early returns.
- Accessibility: ARIA announcements for nearby opponents if needed.

### Testing
- Test file location: `packages/client/test/PhaserGame.test.tsx`
- Test standards: Jest with Colyseus state mocks (simulate onChange with player updates, assert sprite positions/directions, tween calls).
- Cover edge cases: Multiple others, rapid updates, join/leave.

## Change Log
| Date       | Version | Description              | Author          |
|------------|---------|--------------------------|-----------------|
| 2025-09-17 | 1.0     | Initial story doc creation based on epic and code review. | Product Owner   |
| 2025-09-17 | 1.1     | Implemented smooth tweening for other players, handled joins/leaves, added unit tests for updates, removals, multiples, and rapid changes. | Full Stack Developer |