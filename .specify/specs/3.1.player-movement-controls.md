# Story 3.1: Player Movement Controls

## Status
- [x] Draft
- [x] Approved
- [x] In Progress
- [x] Review
- [x] Done

## Story
**As a** player,
**I want** my keyboard inputs to move my character on my screen
**so that** I can control my player.

## Acceptance Criteria
1. Players can use arrow keys (up, down, left, right) or WASD to move their character one tile at a time in the Phaser scene.
2. Movement is smooth and responsive, with a fixed speed (e.g., 200ms per tile).
3. The player sprite collides with maze walls and cannot pass through them.
4. Movement updates the local player position in the Phaser scene.
5. Invalid moves (into walls) are prevented, with no position change.
6. Keyboard focus is on the game canvas for accessibility.

## Tasks / Subtasks
- [x] **Client:** Add keyboard input handling in Phaser MazeScene (use cursor keys or onKeyDown).
- [x] **Client:** Implement player sprite movement logic (tween or direct position update).
- [x] **Client:** Add collision detection against maze grid (check grid[y][x] before moving).
- [x] **Client:** Update player position in local state after valid move.
- [x] **Client:** Ensure movement works only when roundState is 'playing'.
- [x] **Client:** Add unit tests for movement logic (mock Phaser input and grid).

## Dev Notes
- Builds on Story 2.3: Extend PhaserGame and MazeScene for input and collision.
- Use Phaser's built-in cursor keys: this.cursors = this.input.keyboard?.createCursorKeys(); but implemented via onKeyDown for WASD/arrows.
- Player starts at grid[0][0] or random open path; movement: player.x += 32 * direction, but check grid first.
- Refer to `packages/client/app/components/PhaserGame.tsx` for scene integration.
- Defer server sync to Story 3.2; local movement only for now.
- Follow code style: TypeScript, 2-space indentation, camelCase, early returns, descriptive names like handlePlayerMovement.
- Accessibility: Ensure canvas has tabIndex=0 and aria-label; handle onKeyDown in React for fallback.

### Testing
- Test file location: `packages/client/test/PhaserGame.test.tsx`
- Test standards: Jest with Phaser mocks (simulate key events, verify position updates, collision prevention).
- Ensure tests cover valid moves, wall collisions, invalid keys.

## Change Log
| Date       | Version | Description              | Author          |
|------------|---------|--------------------------|-----------------|
| 2025-09-10 | 1.0     | Initial draft of story.  | Full Stack Developer |
| 2025-09-17 | 1.1     | Validated and marked complete per code implementation. | Product Owner   |
| 2025-09-17 | 1.2     | Added unit tests for movement logic. | Full Stack Developer |